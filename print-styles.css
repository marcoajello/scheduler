/* ============================================
   PRINT STYLES FOR SCHEDULER - V3
   Professional output with proper sizing
   ============================================ */

@media print {
  /* ==================== PAGE SETUP ==================== */
  @page {
    margin: 0.4in;
  }
  
  /* Force colors */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  body {
    background: white !important;
    margin: 0;
    padding: 0;
    font-size: 10pt !important;
  }
  
  /* ==================== HIDE ALL UI ==================== */
  header .header-top,
  header .palette,
  header .colpanel,
  .day-tabs-bar,
  .controls,
  footer,
  .fab-container,
  .error-tray,
  button,
  .row-actions,
  .cell-actions,
  .dragHandle,
  .miniBtn,
  .bgBtn,
  .fgBtn,
  .delBtn,
  .upBtn,
  .downBtn,
  .uploadBtn,
  .color-picker-trigger,
  svg,
  .icon,
  select option:not(:checked),
  #pageWidthGuides,
  .page-guide {
    display: none !important;
  }
  
  /* ==================== TITLE SECTION ==================== */
  header .meta {
    display: block !important;
    background: white !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 0 8px 0 !important;
    margin: 0 0 8px 0 !important;
    page-break-after: avoid !important;
    page-break-inside: avoid !important;
  }
  
  /* Hide input fields */
  .meta .compact-meta {
    display: none !important;
  }
  
  /* Show display */
  .meta .meta-display-row {
    display: block !important;
  }
  
  .meta #metaDisplay {
    font-size: 14pt !important;
    font-weight: 700 !important;
    color: #000 !important;
    margin: 0 0 8px 0 !important;
    line-height: 1.3 !important;
  }
  
  /* ==================== TABLE CONTAINER ==================== */
  .container {
    max-width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  main {
    display: block !important;
  }
  
  .schedule-scroll {
    display: block !important;
    overflow: visible !important;
    max-height: none !important;
    height: auto !important;
  }
  
  /* ==================== TABLE STRUCTURE ==================== */
  #scheduleTable {
    display: table !important;
    width: 100% !important;
    border-collapse: collapse !important;
    background: white !important;
    table-layout: fixed !important;
  }
  
  #scheduleTable thead {
    display: table-header-group !important;
  }
  
  #scheduleTable tbody {
    display: table-row-group !important;
  }
  
  /* ==================== TABLE HEADERS ==================== */
  /* All formatting is inline - no CSS rules needed */
  
  /* Hide action columns */
  thead th[data-key="drag"],
  thead th[data-key="actions"],
  tbody td[data-key="drag"],
  tbody td[data-key="actions"] {
    display: none !important;
  }
  
  /* ==================== TABLE ROWS ==================== */
  #scheduleTable tbody tr {
    page-break-inside: avoid !important;
    page-break-after: auto !important;
  }
  
  /* Keep sub-rows with parents */
  #scheduleTable tr.subheader,
  #scheduleTable tr.subchild {
    page-break-before: avoid !important;
  }
  
  /* ==================== COLUMN WIDTHS ==================== */
  #scheduleTable col[data-key="idx"] { width: 22pt; }
  #scheduleTable col[data-key="start"] { width: 50pt; }
  #scheduleTable col[data-key="dash"] { width: 12pt; }
  #scheduleTable col[data-key="end"] { width: 50pt; }
  #scheduleTable col[data-key="duration"] { width: 48pt; }
  #scheduleTable col[data-key="type"] { width: 55pt; }
  
  /* ==================== DASH COLUMN STYLING ==================== */
  td[data-key="dash"] {
    border-left: none !important;
    border-right: none !important;
    border-top: 1pt solid #666 !important;
    border-bottom: 1pt solid #666 !important;
    padding: 6pt 0 !important;
    font-size: 5pt !important;
    color: #666 !important;
    text-align: center !important;
    vertical-align: middle !important;
    font-family: Arial, Helvetica, sans-serif !important;
    font-weight: normal !important;
    font-style: normal !important;
    text-decoration: none !important;
    line-height: 1 !important;
  }
  
  /* Ensure dash content is clean */
  td[data-key="dash"]::before,
  td[data-key="dash"]::after {
    content: none !important;
    display: none !important;
  }
  
  /* Kill any text underlines */
  td[data-key="dash"],
  td[data-key="dash"] * {
    text-decoration: none !important;
    -webkit-text-decoration: none !important;
  }
  
  /* Remove right border from START when adjacent to dash */
  td[data-key="start"] {
    border-right: none !important;
  }
  
  /* Remove left border from END when adjacent to dash */
  td[data-key="end"] {
    border-left: none !important;
  }
  
  /* ==================== IMAGES ==================== */
  .cell-media {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    gap: 2pt !important;
    margin-top: 3pt !important;
  }
  
  .cell-media img {
    width: 100% !important;
    height: auto !important;
    max-height: 30pt !important;
    object-fit: cover !important;
    display: block !important;
    border: 0.5pt solid #ddd !important;
  }
  
  /* Handle 1-2 images */
  .cell-media:has(img:only-child) {
    grid-template-columns: 1fr !important;
  }
  
  .cell-media:has(img:nth-child(2):last-child) {
    grid-template-columns: repeat(2, 1fr) !important;
  }
  
  /* ==================== TEXT CLEANUP ==================== */
  * {
    text-rendering: optimizeLegibility !important;
    -webkit-font-smoothing: antialiased !important;
  }
  
  /* Remove animations */
  *, *::before, *::after {
    animation: none !important;
    transition: none !important;
    transform: none !important;
  }
}

/* ============================================
   END PRINT STYLES
   ============================================ */
